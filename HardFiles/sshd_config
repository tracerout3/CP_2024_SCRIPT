# Hardened SSH Configuration

# Disable root login
PermitRootLogin no

# Disable password authentication (use keys only)
PasswordAuthentication no
PermitEmptyPasswords no

# Limit authentication attempts
MaxAuthTries 3
LoginGraceTime 30

# Disable challenge-response and GSSAPI
ChallengeResponseAuthentication no
GSSAPIAuthentication no

# Enable PAM for account/session restrictions
UsePAM yes

# Restrict login to secure users
AllowUsers admin secureuser

# Strong cryptography only
KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256
Ciphers aes256-gcm@openssh.com,chacha20-poly1305@openssh.com,aes256-ctr
MACs hmac-sha2-512,hmac-sha2-256

# Disable X11 forwarding
X11Forwarding no

# Disable TCP forwarding unless explicitly needed
AllowTcpForwarding no

# Log aggressively
LogLevel VERBOSE

# Disconnect idle sessions
ClientAliveInterval 300
ClientAliveCountMax 2

# Banner for legal notice
Banner /etc/issue.net
